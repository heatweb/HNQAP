{
    "title": "HIU Acceptance Testing",
    "links": [
        {
            "src": "http://www.systemdesigner.co.uk/heatnetwork.php",
            "title": "Heat Network Calculator v1"
        }
    ],
    "sections": [
        {
            "title": "About",
            "questions": [
                {
                    "title": "Reference",
                    "question": "Please give a reference for the site.",
                    "id": "siteRef",
                    "if": "true",
                    "required": "true",
                    "type": "text",
                    "units": ""
                },
                {
                    "title": "Address",
                    "question": "Please give the property address.",
                    "id": "address",
                    "if": "true",
                    "required": "true",
                    "type": "text",
                    "units": ""
                }
            ]
        },
        {
            "title": "HIU Type",
            "questions": [
                {
                    "title": "HIU Types",
                    "question": "Standard data on HIUs.",
                    "id": "hiuTypes",
                    "if": "true",
                    "required": "true",
                    "type": "sheet",
                    "notes": "Add, edit and copy down lines as with a normal spreadsheet. Right click for further actions including deleting lines.",
                    "units": "",
                    "value": [
                        {
                            "hiuType": "DHW Only via PHEx",
                            "typeDHW": "PHEx",
                            "typeHTG": "None"
                        },
                        {
                            "hiuType": "HTG Only via PHEx",
                            "typeDHW": "None",
                            "typeHTG": "PHEx"
                        },
                        {
                            "hiuType": "HTG Only Direct",
                            "typeDHW": "None",
                            "typeHTG": "Direct"
                        },
                        {
                            "hiuType": "DHW & Direct HTG",
                            "typeDHW": "PHEx",
                            "typeHTG": "Direct"
                        },
                        {
                            "hiuType": "Twin PHEx",
                            "typeDHW": "PHEx",
                            "typeHTG": "PHEx"
                        }
                    ],
                    "columns": [
                        {
                            "type": "text",
                            "name": "hiuType",
                            "title": "HIU Type",
                            "width": "200"
                        },
                        {
                            "type": "text",
                            "name": "typeDHW",
                            "title": "DHW",
                            "width": "120",
                            "decimal": "."
                        },
                        {
                            "type": "text",
                            "name": "typeHTG",
                            "title": "HTG",
                            "width": "120",
                            "decimal": "."
                        }
                    ]
                }
            ]
        },
        {
            "title": "Equipment Selection",
            "questions": [
                {
                    "title": "HIU Type",
                    "question": "What type of HIU?",
                    "id": "hiuType",
                    "if": "true",
                    "required": "true",
                    "type": "select",
                    "options": "lookup('hiuTypes','hiuType','hiuType')"
                },
                {
                    "title": "Central heating emitter",
                    "question": "What types of central heating emitter are used?",
                    "id": "typeEmitter",
                    "if": "{{typeHTG}}!='None'",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Radiators",
                            "value": "radiator"
                        },
                        {
                            "title": "Underfloor heating (piped)",
                            "value": "underfloor"
                        },
                        {
                            "title": "Mixed, UFH & Rads",
                            "value": "mixed"
                        },
                        {
                            "title": "Fan convectors",
                            "value": "fan"
                        }
                    ]
                }
            ]
        },
        {
            "title": "Central Heating (2)",
            "questions": [
                {
                    "title": "Radiator flow control",
                    "question": "What types of TRVs are used?",
                    "id": "typeTRV",
                    "if": "'{{typeEmitter}}'=='radiator'",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Basic TRV, with no presetting",
                            "value": "basic TRV"
                        },
                        {
                            "title": "Pre-settable TRV",
                            "value": "presettable TRV"
                        },
                        {
                            "title": "Pressure-independent pre-settable TRV",
                            "value": "PICV TRV"
                        },
                        {
                            "title": "None, isolation only",
                            "value": "isolation"
                        }
                    ]
                },
                {
                    "title": "Radiator return control",
                    "question": "Are return temperature limit valves fitted to radiators?",
                    "id": "typeRTL",
                    "if": "'{{typeEmitter}}'=='radiator'",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Return temperature control",
                            "value": "RTL"
                        },
                        {
                            "title": "None, isolation only",
                            "value": "isolation"
                        }
                    ]
                },
                {
                    "title": "Number of floors",
                    "question": "How many floors are there covered by heating?",
                    "id": "nFloors",
                    "if": "true",
                    "required": "true",
                    "type": "number",
                    "units": ""
                }
            ]
        },
        {
            "title": "Initial Checks",
            "questions": [
                {
                    "title": "HIU Casing",
                    "question": "Is the HIU casing fitted correctly?",
                    "notes": "",
                    "id": "checkCasing",
                    "if": "true",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Fitted and secure",
                            "value": "OK"
                        },
                        {
                            "title": "Fitted, removeable by user",
                            "value": "Fitted"
                        },
                        {
                            "title": "Not fitted properly",
                            "value": "Not fitted"
                        },
                        {
                            "title": "Missing",
                            "value": "Missing"
                        }
                    ]
                },
                {
                    "title": "Check All Off",
                    "question": "Please ensure heating if off and no taps are running.",
                    "notes": "",
                    "id": "allOff1",
                    "if": "'{{typeHTG}}'!='None'",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Done",
                            "value": "Done"
                        }
                    ]
                },
                {
                    "title": "Heat Meter ",
                    "question": "Is a Heat Meter accessible and working?",
                    "notes": "",
                    "id": "checkHeatMeter",
                    "if": "true",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Fitted and working",
                            "value": "OK"
                        },
                        {
                            "title": "Fitted, not accessible",
                            "value": "No access"
                        },
                        {
                            "title": "Not working",
                            "value": "Not working"
                        },
                        {
                            "title": "No Meter Fitted",
                            "value": "Not fitted"
                        }
                    ]
                },
                {
                    "title": "Initial Readings, Meter Energy",
                    "question": "What is current Energy (kWh) reading on the heat meter?",
                    "notes": "Press the button on the meter until it shows kWh.",
                    "id": "kwH1",
                    "if": "'{{checkHeatMeter}}'=='OK'",
                    "required": "true",
                    "type": "number",
                    "units": "°C"
                },
                {
                    "title": "Initial Readings, Meter Flow Rate",
                    "question": "What is highest Flow Rate / Volume Flow on the heat meter over 1 minute?",
                    "notes": "Press the button on the meter until it shows m3h or m3/h. Watch the reading for 1 minute to see the highest reading.",
                    "id": "m3h1",
                    "if": "'{{checkHeatMeter}}'=='OK'",
                    "required": "true",
                    "type": "number",
                    "units": "m3/h"
                },
                {
                    "title": "Initial Readings, Meter Power",
                    "question": "What is current Power (kW) on the heat meter?",
                    "notes": "Press the button on the meter until it shows kW.",
                    "id": "kw1",
                    "if": "'{{checkHeatMeter}}'=='OK'",
                    "required": "true",
                    "type": "number",
                    "units": "kW"
                },
                {
                    "title": "Initial Readings, Meter Flow Temperature",
                    "question": "What is current Flow Temperature on the heat meter?",
                    "notes": "Press the button on the meter until it shows tF or tFlow.",
                    "id": "tF1",
                    "if": "'{{checkHeatMeter}}'=='OK'",
                    "required": "true",
                    "type": "number",
                    "units": "°C"
                },
                {
                    "title": "Initial Readings, Meter Return Temperature",
                    "question": "What is current Return Temperature on the heat meter?",
                    "notes": "Press the button on the meter until it shows tR or tRtn.",
                    "id": "tR1",
                    "if": "'{{checkHeatMeter}}'=='OK'",
                    "required": "true",
                    "type": "number",
                    "units": "°C"
                }
            ]
        },
        {
            "title": "HIU Checks",
            "questions": [
                {
                    "title": "Remove Casing",
                    "question": "Please remove the HIU casing.",
                    "notes": "",
                    "id": "removeCasing",
                    "if": "true",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Done",
                            "value": "Done"
                        }
                    ]
                },
                {
                    "title": "Initial Central Heating Pressure",
                    "question": "What is the central heating pressure?",
                    "notes": "Please read from available pressure gauge.",
                    "id": "pHTG1",
                    "if": "'{{typeHTG}}'=='PHEx'",
                    "required": "true",
                    "type": "number",
                    "units": "bar"
                },
                {
                    "title": "Check Filling Loop",
                    "question": "Please confirm the state of the central heating filling loop.",
                    "notes": "",
                    "id": "checkFLoop1",
                    "if": "'{{typeHTG}}'=='PHEx'",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Disconnected & Capped",
                            "value": "OK"
                        },
                        {
                            "title": "Disconnected, Not Capped",
                            "value": "Uncapped"
                        },
                        {
                            "title": "Connected.",
                            "value": "Connected"
                        }
                    ]
                }
            ]
        },
        {
            "title": "Initial Fixes",
            "questions": [
                {
                    "title": "Top-up Heating Pressure",
                    "question": "Top up the central heating pressure to between 1.5 and 2 bar. Record pressure below.",
                    "notes": "Use the provided filling loop.",
                    "id": "pHTG2",
                    "if": "('{{typeHTG}}'=='PHEx') && ({{pHTG1}}<1.5)",
                    "required": "true",
                    "type": "number",
                    "units": "bar"
                }
            ]
        },
        {
            "title": "DHW Tests",
            "questions": [
                {
                    "title": "Time for Kitchen Tap to reach 45°C",
                    "question": "Start the kitchen tap, timing how long it takes for the tap temperature to reach 45°C?",
                    "notes": "A stopwatch and temperature probe are required for this step.",
                    "id": "tapTime45C",
                    "if": "'{{typeDHW}}'=='PHEx'",
                    "required": "true",
                    "type": "number",
                    "units": "seconds"
                },
                {
                    "title": "Final Kitchen Tap Temperature",
                    "question": "What is the final temperature of the kitchen tap after it has settled?",
                    "notes": "A temperature probe is required for this step. Leave at least 60 seconds to settle. Leave tap running for next stages.",
                    "id": "tDHW1",
                    "if": "'{{typeDHW}}'=='PHEx'",
                    "required": "true",
                    "type": "number",
                    "units": "°C"
                }
            ]
        },
        {
            "title": "Final Checks",
            "questions": [
                {
                    "title": "Final Central Heating Pressure",
                    "question": "What is the final central heating pressure?",
                    "notes": "Please read from available pressure gauge.",
                    "id": "pHTG3",
                    "if": "'{{typeHTG}}'=='PHEx'",
                    "required": "true",
                    "type": "number",
                    "units": "bar"
                },
                {
                    "title": "Filling Loop Disconnected & Capped",
                    "question": "Please confirm the central heating filling loop is disconnected and capped.",
                    "notes": "",
                    "id": "checkFLoop2",
                    "if": "'{{typeHTG}}'=='PHEx'",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Disconnected & Capped",
                            "value": "OK"
                        },
                        {
                            "title": "Disconnected, Not Capped",
                            "value": "Uncapped"
                        }
                    ]
                },
                {
                    "title": "Refit Casing",
                    "question": "Please refit the HIU casing.",
                    "notes": "",
                    "id": "refitCasing",
                    "if": "true",
                    "required": "true",
                    "type": "select",
                    "options": [
                        {
                            "title": "Done",
                            "value": "Done"
                        }
                    ]
                }
            ]
        }
    ],
    "calculations": [
        {
            "id": "typeDHW",
            "title": "DHW Connection",
            "if": "'{{hiuType}}'!==''",
            "vlookup": [
                "hiuTypes",
                "typeDHW",
                "hiuType",
                "hiuType"
            ],
            "units": ""
        },
        {
            "id": "typeHTG",
            "title": "Central Heating Connection",
            "if": "'{{hiuType}}'!==''",
            "vlookup": [
                "hiuTypes",
                "typeHTG",
                "hiuType",
                "hiuType"
            ],
            "units": ""
        },
        {
            "id": "perimeterRect",
            "title": "Building external perimeter estimate",
            "if": "false",
            "function": "({{bLength}} * 2) + ({{bWidth}} * 2)",
            "units": "m"
        }
    ]
}